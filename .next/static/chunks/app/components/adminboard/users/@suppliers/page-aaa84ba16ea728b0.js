(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4606],{16865:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>i});var l=a(95155),t=a(94553),r=a(60668),n=a(23464),d=a(12115);function i(){let[e,s]=(0,d.useState)([]),[a,i]=(0,d.useState)([]),[o,c]=(0,d.useState)(null),[m,u]=(0,d.useState)(""),[h,p]=(0,d.useState)(!1),[b,x]=(0,d.useState)({text:"",type:""}),j=(0,t.b)();(0,d.useEffect)(()=>{(async()=>{try{p(!0);let e=await n.A.get("".concat(r.M,"/admin_users_by_role?role=supplier"),{headers:{Authorization:"Bearer ".concat(j)}}),a=await n.A.get("".concat(r.M,"/admin_user_enums"),{headers:{Authorization:"Bearer ".concat(j)}});s(e.data.byRole),i(a.data.userEnums),p(!1)}catch(e){console.log("There was a problem fetching suppliers"),p(!1),x({text:"Failed to load suppliers",type:"danger"})}})()},[j]);let N=e=>{c(e),u(e.role)},g=async()=>{if(o&&m)try{var a,l;p(!0);let t=await n.A.put("".concat(r.M,"/admin_manage_user_account/").concat(o._id),{role:m},{headers:{Authorization:"Bearer ".concat(j)}});console.log(t.data.msg);let d=e.map(e=>e._id===o._id?{...e,role:m}:e);s(d),x({text:"User role updated successfully",type:"success"}),null===(l=window.bootstrap)||void 0===l||null===(a=l.Modal.getInstance(document.getElementById("editRoleModal")))||void 0===a||a.hide(),p(!1)}catch(e){console.error("Error updating user role:",e),x({text:"Failed to update user role",type:"danger"}),p(!1)}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"container mt-4",children:[(0,l.jsx)("h2",{className:"mb-4",children:"Suppliers"}),b.text&&(0,l.jsxs)("div",{className:"alert alert-".concat(b.type," alert-dismissible fade show"),role:"alert",children:[b.text,(0,l.jsx)("button",{type:"button",className:"btn-close",onClick:()=>x({text:"",type:""})})]}),h?(0,l.jsx)("div",{className:"d-flex justify-content-center",children:(0,l.jsx)("div",{className:"spinner-border",role:"status",children:(0,l.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):e.length>0?(0,l.jsx)("div",{className:"card",children:(0,l.jsx)("ul",{className:"list-group list-group-flush",children:e.map(e=>(0,l.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h5",{className:"mb-1",children:e.fullname}),(0,l.jsx)("p",{className:"mb-1 text-muted",children:e.email}),(0,l.jsx)("span",{className:"badge bg-primary rounded-pill",children:e.role})]}),(0,l.jsx)("button",{className:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#editRoleModal",onClick:()=>N(e),children:"Edit Role"})]},e._id))})}):(0,l.jsx)("div",{className:"alert alert-info",children:"No Supplier found."})]}),(0,l.jsx)("div",{className:"modal fade",id:"editRoleModal",tabIndex:"-1","aria-labelledby":"editRoleModalLabel","aria-hidden":"true",children:(0,l.jsx)("div",{className:"modal-dialog",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h5",{className:"modal-title",id:"editRoleModalLabel",children:"Update User Role"}),(0,l.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),(0,l.jsx)("div",{className:"modal-body",children:o&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Name:"})," ",o.fullname]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Email:"})," ",o.email]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Current Role:"})," ",o.role]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{htmlFor:"newRole",className:"form-label",children:"New Role"}),(0,l.jsxs)("select",{className:"form-select",id:"newRole",value:m,onChange:e=>u(e.target.value),children:[(0,l.jsx)("option",{value:"",children:"Select Role"}),null==a?void 0:a.map((e,s)=>(0,l.jsx)("option",{value:e,children:e},s))]})]})]})}),(0,l.jsxs)("div",{className:"modal-footer",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancel"}),(0,l.jsx)("button",{type:"button",className:"btn btn-primary",onClick:g,disabled:h,children:h?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):"Update Role"})]})]})})})]})}},60668:(e,s,a)=>{"use strict";a.d(s,{M:()=>l});let l="https://seedverify-3.onrender.com"},86338:(e,s,a)=>{Promise.resolve().then(a.bind(a,16865))},94553:(e,s,a)=>{"use strict";a.d(s,{b:()=>l});let l=()=>localStorage.getItem("usertoken")}},e=>{var s=s=>e(e.s=s);e.O(0,[3464,8441,1684,7358],()=>s(86338)),_N_E=e.O()}]);