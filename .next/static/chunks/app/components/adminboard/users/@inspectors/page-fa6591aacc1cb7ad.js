(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2319],{3300:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>r});var s=t(95155),l=t(94553),n=t(60668),d=t(23464),o=t(12115);function r(){let[e,a]=(0,o.useState)([]),[t,r]=(0,o.useState)([]),[c,m]=(0,o.useState)(null),[p,u]=(0,o.useState)(""),[h,b]=(0,o.useState)(!1),[x,j]=(0,o.useState)({text:"",type:""}),y=(0,l.b)();(0,o.useEffect)(()=>{(async()=>{try{b(!0);let e=await d.A.get("".concat(n.M,"/admin_users_by_role?role=inspector"),{headers:{Authorization:"Bearer ".concat(y)}}),t=await d.A.get("".concat(n.M,"/admin_user_enums"),{headers:{Authorization:"Bearer ".concat(y)}});a(e.data.byRole),r(t.data.userEnums),b(!1)}catch(e){console.log("There was a problem fetching inspectors"),b(!1),j({text:"Failed to load inspectors",type:"danger"})}})()},[y]);let N=e=>{m(e),u(e.role)},g=async()=>{if(c&&p)try{var t,s;b(!0),await d.A.put("".concat(n.M,"/admin_manage_user_account/").concat(c._id),{role:p},{headers:{Authorization:"Bearer ".concat(y)}});let l=e.map(e=>e._id===c._id?{...e,role:p}:e);a(l),j({text:"User role updated successfully",type:"success"}),null===(s=window.bootstrap)||void 0===s||null===(t=s.Modal.getInstance(document.getElementById("editRoleModal")))||void 0===t||t.hide(),window.location.reload(),b(!1)}catch(e){console.error("Error updating user role:",e),j({text:"Failed to update user role",type:"danger"}),b(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"container mt-4",children:[(0,s.jsx)("h2",{className:"mb-4",children:"Inspectors"}),x.text&&(0,s.jsxs)("div",{className:"alert alert-".concat(x.type," alert-dismissible fade show"),role:"alert",children:[x.text,(0,s.jsx)("button",{type:"button",className:"btn-close",onClick:()=>j({text:"",type:""})})]}),h?(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)("div",{className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):e.length>0?(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("ul",{className:"list-group list-group-flush",children:e.map(e=>(0,s.jsxs)("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"mb-1",children:e.fullname}),(0,s.jsx)("p",{className:"mb-1 text-muted",children:e.email}),(0,s.jsx)("span",{className:"badge bg-primary rounded-pill",children:e.role})]}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"badge bg-primary rounded-pill",style:{cursor:"pointer"},title:"Click to update inspector type",children:(0,s.jsx)(i,{inspectorId:null==e?void 0:e._id})})}),(0,s.jsx)("button",{className:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#editRoleModal",onClick:()=>N(e),children:"Edit Role"})]},e._id))})}):(0,s.jsx)("div",{className:"alert alert-info",children:"No inspectors found."})]}),(0,s.jsx)("div",{className:"modal fade",id:"editRoleModal",tabIndex:"-1","aria-labelledby":"editRoleModalLabel","aria-hidden":"true",children:(0,s.jsx)("div",{className:"modal-dialog",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",id:"editRoleModalLabel",children:"Update User Role"}),(0,s.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),(0,s.jsx)("div",{className:"modal-body",children:c&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Name:"})," ",c.fullname]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Email:"})," ",c.email]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Current Role:"})," ",c.role]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{htmlFor:"newRole",className:"form-label",children:"New Role"}),(0,s.jsxs)("select",{className:"form-select",id:"newRole",value:p,onChange:e=>u(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select Role"}),null==t?void 0:t.map((e,a)=>(0,s.jsx)("option",{value:e,children:e},a))]})]})]})}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancel"}),(0,s.jsx)("button",{type:"button",className:"btn btn-primary",onClick:g,disabled:h,children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Updating..."]}):"Update Role"})]})]})})})]})}let i=e=>{let{inspectorId:a}=e,[t,r]=(0,o.useState)({}),[i,c]=(0,o.useState)([]),[m,p]=(0,o.useState)(""),[u,h]=(0,o.useState)(!1),[b,x]=(0,o.useState)(""),j=(0,l.b)();(0,o.useEffect)(()=>{(async()=>{try{let e=await d.A.get("".concat(n.M,"/admin_get_inspector/").concat(a),{headers:{Authorization:"Bearer ".concat(j)}}),t=await d.A.get("".concat(n.M,"/admin_inspector_type_enums"),{headers:{Authorization:"Bearer ".concat(j)}});r(e.data.inspector),c(t.data.inspectorEnums),p(e.data.inspector.inspectorType||"")}catch(e){console.log("There was a problem")}})()},[a,j]);let y=async()=>{try{var e,s;h(!0),await d.A.put("".concat(n.M,"/admin_update_inspector_type/").concat(t._id),{inspectorType:m},{headers:{Authorization:"Bearer ".concat(j)}}),r(e=>({...e,inspectorType:m})),x("Inspector type updated"),h(!1),null===(s=window.bootstrap)||void 0===s||null===(e=s.Modal.getInstance(document.getElementById("inspectorTypeModal-".concat(a))))||void 0===e||e.hide(),window.location.reload()}catch(e){console.log("Failed to update inspector type"),x("Failed to update inspector type"),h(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"badge bg-primary rounded-pill",style:{cursor:"pointer"},title:"Click to update inspector type","data-bs-toggle":"modal","data-bs-target":"#inspectorTypeModal-".concat(a),children:(null==t?void 0:t.inspectorType)||"N/A"}),(0,s.jsx)("div",{className:"modal fade",id:"inspectorTypeModal-".concat(a),tabIndex:"-1","aria-labelledby":"inspectorTypeModalLabel-".concat(a),"aria-hidden":"true",children:(0,s.jsx)("div",{className:"modal-dialog",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",id:"inspectorTypeModalLabel-".concat(a),children:"Update Inspector Type"}),(0,s.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),(0,s.jsxs)("div",{className:"modal-body",children:[b&&(0,s.jsx)("div",{className:"alert alert-info",children:b}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{htmlFor:"newType-".concat(a),className:"form-label",children:"Inspector Type"}),(0,s.jsxs)("select",{className:"form-select",id:"newType",value:m,onChange:e=>p(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Select Type "}),null==i?void 0:i.map((e,a)=>(0,s.jsx)("option",{value:e,children:e},a))]})]})]}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancel"}),(0,s.jsx)("button",{className:"btn btn-primary",onClick:y,disabled:u,children:u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Updating..."]}):"Update Type"})]})]})})})]})}},42323:(e,a,t)=>{Promise.resolve().then(t.bind(t,3300))},60668:(e,a,t)=>{"use strict";t.d(a,{M:()=>s});let s="https://seedverify-3.onrender.com"},94553:(e,a,t)=>{"use strict";t.d(a,{b:()=>s});let s=()=>localStorage.getItem("usertoken")}},e=>{var a=a=>e(e.s=a);e.O(0,[3464,8441,1684,7358],()=>a(42323)),_N_E=e.O()}]);